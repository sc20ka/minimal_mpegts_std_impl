# Minimal MPEG-TS Standard Implementation

## 📖 Описание проекта

Это минималистичная реализация MPEG-TS (ISO/IEC 13818-1) демультиплексора на C++17, созданная для образовательных целей и практического применения в задачах обработки транспортных потоков.

## 🎯 Назначение

Проект предоставляет чистую, профайл-агностичную реализацию демультиплексора MPEG-TS с фокусом на:

- **Потоковую обработку** MPEG-TS данных с высокой надёжностью
- **Адаптивную синхронизацию** в условиях помех и мусора
- **Восстановление** валидных пакетов из произвольных данных
- **Разделение** основной полезной нагрузки и приватных данных
- **Управление** несколькими программами и потоками одновременно

## ⚠️ Текущая стадия разработки

**ALPHA v0.1.0 - Initial Demuxing Stage**

На данный момент проект находится на **начальной стадии разработки** и реализует **исключительно функционал демультиплексирования (demuxing)**:

- ✅ Базовая синхронизация MPEG-TS пакетов
- ✅ Трёхитеративная валидация потоков
- ✅ Извлечение payload данных (normal + private)
- ✅ Обработка continuity counter
- ✅ Адаптивное восстановление после помех

### Что НЕ реализовано (пока)

- ❌ PAT/PMT парсирование (работа без таблиц программ)
- ❌ PCR-based синхронизация
- ❌ PES декодирование
- ❌ DVB/ATSC специфичные функции
- ❌ Descrambling (расшифровка)
- ❌ Продвинутая обработка метаданных

## 🏗️ Архитектура

### Ключевые компоненты

```
┌─────────────────────────────────────────┐
│  MPEG-TS Stream Input (raw bytes)      │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│  Adaptive Buffer (18.8 KB circular)    │
│  - Accumulates packets                  │
│  - Handles garbage filtering            │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│  Synchronization Engine                 │
│  - 0x47 sync byte detection             │
│  - 3-iteration validation               │
│  - Continuity counter check             │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│  Stream Storage                         │
│  - PID-based organization               │
│  - Iteration tracking                   │
│  - Payload separation (normal/private)  │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│  User API                               │
│  - feedData()                           │
│  - getPayload()                         │
│  - getIterations()                      │
└─────────────────────────────────────────┘
```

## 🛠️ Технические характеристики

| Параметр                  | Значение                           |
| ------------------------- | ---------------------------------- |
| Язык                      | C++17                              |
| Стандарт                  | ISO/IEC 13818-1 (MPEG-TS)          |
| Размер пакета             | 188 байт (без 192-byte mode)       |
| Буфер                     | 100 пакетов (18.8 KB)              |
| Валидация синхронизации   | 3-итеративная (trinary)            |
| Поддержка видеокодеков    | H.264, H.265 (любые MPEG-TS типы)  |
| Приватные данные          | Полная поддержка                   |
| Scrambled контент         | НЕ поддерживается                  |
| Профили                   | Profile-agnostic                   |

## 📦 Сборка проекта

### Требования

- CMake 3.15+
- Компилятор с поддержкой C++17 (GCC 7+, Clang 5+, MSVC 2017+)

### Сборка

```bash
# Клонирование репозитория
git clone <repository-url>
cd minimal_mpegts_std_impl

# Создание build директории
mkdir build && cd build

# Конфигурация
cmake ..

# Сборка
cmake --build .

# Опционально: сборка с примерами
cmake -DBUILD_EXAMPLES=ON ..
cmake --build .
```

## 📚 Использование

```cpp
#include "mpegts_demuxer.hpp"

int main() {
    MPEGTSDemuxer demuxer;

    // Подача данных
    uint8_t buffer[4096];
    size_t bytes_read = read_stream(buffer, sizeof(buffer));
    demuxer.feedData(buffer, bytes_read);

    // Проверка синхронизации
    if (demuxer.isSynchronized()) {
        auto programs = demuxer.getPrograms();
        // Обработка найденных программ
    }

    return 0;
}
```

Подробные примеры доступны в директории `examples/`.

## 📋 Roadmap

### Phase 1: Core Demuxing (текущая фаза)
- [x] Базовая структура проекта
- [ ] Реализация адаптивного буфера
- [ ] Синхронизация и валидация пакетов
- [ ] Хранилище потоков
- [ ] Базовый API

### Phase 2: Advanced Features
- [ ] PAT/PMT парсирование
- [ ] PCR обработка
- [ ] PES декодирование
- [ ] Улучшенная обработка ошибок

### Phase 3: Optimization & Extensions
- [ ] Производительность и оптимизации
- [ ] Multi-threading support
- [ ] DVB-специфичные функции (опционально)

## 📄 Документация

Полная техническая спецификация доступна в файле [todo.md](todo.md).

## 📜 Лицензия

См. файл [LICENSE](LICENSE)

## 🤝 Контрибуция

Проект находится на ранней стадии разработки. Контрибуции приветствуются после завершения core функционала.

## ⚡ Статус

- **Версия:** 0.1.0-alpha
- **Статус:** В разработке (Core Demuxing)
- **Последнее обновление:** November 2025

---

**Note:** Это образовательный проект с фокусом на чистую реализацию стандарта MPEG-TS. Для production использования рекомендуется libavformat (FFmpeg) или аналогичные зрелые библиотеки.
